Почему-то больше всего времени потратил на последнюю задачу.
Решил ее несколькими способами, результаты сходятся, но кажется, я не самым оптимальным путем опять пошел. 
